<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
<!-- saved from url=(0014)about:internet -->

    <meta http-equiv="X-UA-Compatible" value="IE=9" />

    

    

    <title>Create various entities and link them</title>
    <meta name="Title" content="Create various entities and link them"/>    
    
    <script src="script/jquery-1.7.2.min.js" type="text/javascript" id="mshs_support_script"></script>
    <script src="script/jquery-ui-1.8.18.custom.min.js" type="text/javascript"></script>
    <link rel="styleSheet" type="text/css" href="stylesheets/jquery-ui-1.8.18.custom.css" />
    <link rel="styleSheet" type="text/css" href="stylesheets/jquery.qtip.css" />
	
    
	

    <meta name="Description" content="
    
        Links Examples
    

    
        
Public Function LinkDefectsToEntities(folder As SubjectNode, _
                oTest As Test) As Boolean

' Create various entities and link them

'-----------------------------------------" />
    
    <link rel="styleSheet" type="text/css" href="stylesheets/topics.2012.css" data-mshv2-stylesheet="/stylesheets/topics.2012.mshv2.css" />
    <script src="script/topics.jqueryplugins.2012.min.js" type="text/javascript"></script>
    <script src="script/topics.2012.js" type="text/javascript"></script>
    
    <meta name="Microsoft.Help.Id" content="55e0955a-fad7-48be-9324-8dc906d06a11"/>
    
    
    <meta name="Microsoft.Help.F1" content=""/>
    <meta name="Microsoft.Help.ContentType" content="Concepts" />
    
    
    
    
    
    <link rel="stylesheet" type="text/css" href="stylesheets/slimbox2.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-jquery-common.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-jquery-slimbox.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-jquery-expand.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-boxes.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-expandcollapse.css"></link>
    <script src="script/jquery-1.7.2.min.js" type="text/javascript"></script>
    <script src="script/slimbox2.js" type="text/javascript"></script>
    <script src="script/hs-jquery-common.js" type="text/javascript"></script>
    <script src="script/jquery.fitvids.js" type="text/javascript"></script>
    <script src="script/jquery-expand.js" type="text/javascript"></script>
    <script src="script/swfobject.js" type="text/javascript"></script>
    <script src="script/hs-expandcollapse.js" type="text/javascript"></script>

    
    

    

    
</head>

<body>
    <div id="BeforeHeaderContent">
        
    </div>
    <div id="HeaderContent">
        
            
            <div id="ProjectTitle">ALM Open Test Architecture API Reference (Version 12.5x)</div>
        <div id="PageTitle"><div id="PageTitleText">Create various entities and link them</div></div>
    </div>
    <div id="AfterHeaderContent">
        <!-- Spacing --> <span id="ToggleAllSectionsLink" class="FunctionLink">
                <label id="CollapseAllLabel">Collapse All</label>
                <label id="ExpandAllLabel" style="display: none;">Expand All</label>
            </span>
        
    </div>
    
    
    
    <div id="BodyContent">
        <div class="FilteredContentVisual Basic TabContainer TabContainerWidget" data-title="Links Examples" data-itemid="Visual Basic">
    <ul>
        <li><a href="#TabContent-8922ec11-0f91-46bc-b31c-efc0fca8c4a2">Links Examples</a></li>
    </ul>

    <div id="TabContent-8922ec11-0f91-46bc-b31c-efc0fca8c4a2" class="FilteredContent code">
        <pre>
<span style="COLOR: #0000ff">Public</span> <span style="COLOR: #0000ff">Function</span> LinkDefectsToEntities(folder <span style="COLOR: #0000ff">As</span> SubjectNode, _
                oTest <span style="COLOR: #0000ff">As</span> Test) <span style="COLOR: #0000ff">As</span> <span style="COLOR: #0000ff">Boolean</span>

<span style="COLOR: #008000">' Create various entities and link them
</span>
<span style="COLOR: #008000">'-----------------------------------------------------------
' This example creates a test and a test set with test steps.
' It then creates three defects and links them to the test,
' the run, and the test step.
'-----------------------------------------------------------
</span>    <span style="COLOR: #0000ff">Dim</span> testF <span style="COLOR: #0000ff">As</span> TestFactory
<span style="COLOR: #008000">'    Dim oTest As Test
'    Dim StepF As DesignStepFactory
</span>    <span style="COLOR: #0000ff">Dim</span> desstep <span style="COLOR: #0000ff">As</span> DesignStep
    <span style="COLOR: #008000">'Dim oRoot As SubjectNode, folder As SubjectNode
</span>    <span style="COLOR: #0000ff">Dim</span> TreeMgr <span style="COLOR: #0000ff">As</span> TreeManager
    <span style="COLOR: #0000ff">Dim</span> labTreeMgr <span style="COLOR: #0000ff">As</span> TestSetTreeManager
    <span style="COLOR: #0000ff">Dim</span> labFolder <span style="COLOR: #0000ff">As</span> SysTreeNode, labTreeRoot <span style="COLOR: #0000ff">As</span> SysTreeNode
    <span style="COLOR: #0000ff">Dim</span> BugF <span style="COLOR: #0000ff">As</span> BugFactory
    <span style="COLOR: #0000ff">Dim</span> Bug1 <span style="COLOR: #0000ff">As</span> Bug, Bug2 <span style="COLOR: #0000ff">As</span> Bug, bug3 <span style="COLOR: #0000ff">As</span> Bug
    <span style="COLOR: #0000ff">Dim</span> testSetF <span style="COLOR: #0000ff">As</span> TestSetFactory
    <span style="COLOR: #0000ff">Dim</span> TstSet <span style="COLOR: #0000ff">As</span> TestSet
    <span style="COLOR: #0000ff">Dim</span> testInstanceF <span style="COLOR: #0000ff">As</span> TSTestFactory
    <span style="COLOR: #0000ff">Dim</span> tstInstance <span style="COLOR: #0000ff">As</span> TSTest
    <span style="COLOR: #0000ff">Dim</span> RunF <span style="COLOR: #0000ff">As</span> RunFactory
    <span style="COLOR: #0000ff">Dim</span> theRun <span style="COLOR: #0000ff">As</span> Run
    <span style="COLOR: #0000ff">Dim</span> runStepF <span style="COLOR: #0000ff">As</span> StepFactory
    <span style="COLOR: #0000ff">Dim</span> runStep <span style="COLOR: #0000ff">As</span> <span style="COLOR: #0000ff">Step</span>, runStep2 <span style="COLOR: #0000ff">As</span> <span style="COLOR: #0000ff">Step</span>
    <span style="COLOR: #0000ff">Dim</span> testID <span style="COLOR: #0000ff">As</span> <span style="COLOR: #0000ff">String</span>
    <span style="COLOR: #0000ff">Dim</span> lst <span style="COLOR: #0000ff">As</span> List, Item
    <span style="COLOR: #0000ff">Dim</span> TestName <span style="COLOR: #0000ff">As</span> <span style="COLOR: #0000ff">String</span>
    
    <span style="COLOR: #0000ff">On</span> <span style="COLOR: #0000ff">Error</span> <span style="COLOR: #0000ff">GoTo</span> LinkDefectsToEntitiesErr
    TestName = oTest.name
    
<span style="COLOR: #008000">'tdc is a TDConnection object. When this routine is run,
' the user is authenticated and connected to the project.
</span>    <span style="COLOR: #0000ff">Set</span> TreeMgr = tdc.TreeManager
    <span style="COLOR: #0000ff">Set</span> testF = tdc.TestFactory
    <span style="COLOR: #0000ff">Set</span> labTreeMgr = tdc.TestSetTreeManager
    <span style="COLOR: #0000ff">Set</span> BugF = tdc.BugFactory
<span style="COLOR: #008000">'------------------------------------------
' Test Plan
'------------------------------------------
</span> <span style="COLOR: #0000ff">Get</span> <span style="COLOR: #0000ff">or</span> create a test plan subject folder.
    errmsg = <span style="COLOR: #800000">"Subject tree error"</span>
    <span style="COLOR: #0000ff">Set</span> oRoot = TreeMgr.TreeRoot(<span style="COLOR: #800000">"Subject"</span>)
    <span style="COLOR: #0000ff">On</span> <span style="COLOR: #0000ff">Error</span> <span style="COLOR: #0000ff">Resume</span> <span style="COLOR: #0000ff">Next</span>
    <span style="COLOR: #0000ff">Set</span> folder = oRoot.FindChildNode(FolderName)
    <span style="COLOR: #0000ff">On</span> <span style="COLOR: #0000ff">Error</span> <span style="COLOR: #0000ff">GoTo</span> LinkDefectsToEntitiesErr
    <span style="COLOR: #0000ff">If</span> folder <span style="COLOR: #0000ff">Is</span> <span style="COLOR: #0000ff">Nothing</span> <span style="COLOR: #0000ff">Then</span> _
        <span style="COLOR: #0000ff">Set</span> folder = oRoot.AddNode(FolderName)


<span style="COLOR: #008000">'' Create a design test.
</span>    errmsg = <span style="COLOR: #800000">"Design test error"</span>
    <span style="COLOR: #008000">' Get the test if it exists.
</span>    <span style="COLOR: #008000">' For the code of GetTest, see the Test object example:
</span>    <span style="COLOR: #008000">'  "Get a test object with name and path"
</span>    <span style="COLOR: #0000ff">Set</span> oTest = GetTest(TestName, FolderName)
    <span style="COLOR: #008000">' If the test doesn't exist, create it.
</span>    <span style="COLOR: #0000ff">If</span> oTest <span style="COLOR: #0000ff">Is</span> <span style="COLOR: #0000ff">Nothing</span> <span style="COLOR: #0000ff">Then</span>
        <span style="COLOR: #0000ff">Set</span> oTest = testF.AddItem(Null)
        oTest.name = TestName
        oTest.Type = <span style="COLOR: #800000">"MANUAL"</span>
        <span style="COLOR: #008000">' Put the test in the new subject folder.
</span>        oTest.Field(<span style="COLOR: #800000">"TS_SUBJECT"</span>) = folder.NodeID
        oTest.Post
    <span style="COLOR: #0000ff">End</span> <span style="COLOR: #0000ff">If</span>
 

<span style="COLOR: #008000">'' Get or create a design step from the factory of the new test.
</span>    errmsg = <span style="COLOR: #800000">"Design step error"</span>
    <span style="COLOR: #0000ff">Set</span> StepF = oTest.DesignStepFactory
    <span style="COLOR: #0000ff">Dim</span> aFilter <span style="COLOR: #0000ff">As</span> TDFilter
    <span style="COLOR: #0000ff">Set</span> aFilter = StepF.Filter
    <span style="COLOR: #0000ff">Dim</span> StepName$
    StepName = TestName &amp; <span style="COLOR: #800000">"Step_1"</span>
    aFilter.Filter(<span style="COLOR: #800000">"DS_STEP_NAME"</span>) = StepName
    <span style="COLOR: #0000ff">Set</span> lst = StepF.NewList(aFilter.Text)
    <span style="COLOR: #0000ff">If</span> lst.Count = 0 <span style="COLOR: #0000ff">Then</span>
        <span style="COLOR: #0000ff">Set</span> desStep = StepF.AddItem(Null)
        desStep.StepName = StepName
        desStep.StepDescription = <span style="COLOR: #800000">"Step to be linked to defect."</span>
        desStep.StepExpectedResult = <span style="COLOR: #800000">"This step expected to be linked."</span>
        desStep.Post
    <span style="COLOR: #0000ff">Else</span>
        <span style="COLOR: #0000ff">Set</span> desStep = lst.Item(1)
    <span style="COLOR: #0000ff">End</span> <span style="COLOR: #0000ff">If</span>

    <span style="COLOR: #0000ff">Dim</span> StepName$
    StepName = oTest.name &amp; <span style="COLOR: #800000">"Step_1"</span>
    <span style="COLOR: #0000ff">Set</span> desstep = GetDesignStep(oTest, StepName, _
            <span style="COLOR: #800000">"Step to be linked to defect"</span>, _
            <span style="COLOR: #800000">"This step expected to be linked."</span>)
    
<span style="COLOR: #008000">'-----------------------------------------
' Test Lab
'------------------------------------------
' Get or create a test set folder.
</span>    errmsg = <span style="COLOR: #800000">"Lab node error"</span>
    <span style="COLOR: #0000ff">Dim</span> tsFolderName$, tsFolderPath$
    tsFolder = FolderName &amp; <span style="COLOR: #800000">"_TS"</span>
    tsFolderPath = <span style="COLOR: #800000">"Root\"</span> &amp; tsFolder
    <span style="COLOR: #0000ff">On</span> <span style="COLOR: #0000ff">Error</span> <span style="COLOR: #0000ff">Resume</span> <span style="COLOR: #0000ff">Next</span>
    <span style="COLOR: #0000ff">Set</span> labFolder = AddTestSetFolder(<span style="COLOR: #800000">"LinkTestSets"</span>)
    
    <span style="COLOR: #0000ff">Set</span> labFolder = labTreeMgr.NodeByPath(tsFolderPath)
    <span style="COLOR: #0000ff">On</span> <span style="COLOR: #0000ff">Error</span> <span style="COLOR: #0000ff">GoTo</span> LinkDefectsToEntitiesErr
    <span style="COLOR: #0000ff">If</span> labFolder <span style="COLOR: #0000ff">Is</span> <span style="COLOR: #0000ff">Nothing</span> <span style="COLOR: #0000ff">Then</span>
        <span style="COLOR: #0000ff">Set</span> labTreeRoot = labTreeMgr.Root
        <span style="COLOR: #0000ff">Set</span> labFolder = labTreeRoot.AddNode(tsFolder)
        labTreeRoot.Post
    <span style="COLOR: #0000ff">End</span> <span style="COLOR: #0000ff">If</span>

<span style="COLOR: #008000">' Get or create a test set from the factory of the new folder.
</span>    errmsg = <span style="COLOR: #800000">"Test set error"</span>
    <span style="COLOR: #0000ff">Dim</span> tsName$
    tsName = TestName &amp; <span style="COLOR: #800000">"_TS"</span>
    <span style="COLOR: #0000ff">Set</span> testSetF = labFolder.TestSetFactory
    <span style="COLOR: #0000ff">Set</span> aFilter = testSetF.Filter
    aFilter.Filter(<span style="COLOR: #800000">"CY_CYCLE"</span>) = tsName
    <span style="COLOR: #0000ff">Set</span> lst = testSetF.NewList(aFilter.Text)
    <span style="COLOR: #0000ff">If</span> lst.Count = 0 <span style="COLOR: #0000ff">Then</span>
        <span style="COLOR: #0000ff">Set</span> TstSet = testSetF.AddItem(Null)
        TstSet.Field(<span style="COLOR: #800000">"CY_CYCLE"</span>) = tsName
        TstSet.Post
    <span style="COLOR: #0000ff">Else</span>
        <span style="COLOR: #0000ff">Set</span> TstSet = lst.Item(1)
    <span style="COLOR: #0000ff">End</span> <span style="COLOR: #0000ff">If</span>
  <span style="COLOR: #0000ff">Set</span> TstSet = GetTestSet(labFolder, <span style="COLOR: #800000">"LinkTestTS"</span>, <span style="COLOR: #800000">"Open"</span>)
   
<span style="COLOR: #008000">' Get or create a test instance from the factory of the new test set.
</span>    errmsg = <span style="COLOR: #800000">"Test instance error"</span>
    <span style="COLOR: #0000ff">Set</span> testInstanceF = TstSet.TSTestFactory
    <span style="COLOR: #0000ff">Set</span> aFilter = testInstanceF.Filter
    aFilter.Filter(<span style="COLOR: #800000">"TC_TEST_ID"</span>) = oTest.ID
    <span style="COLOR: #0000ff">Set</span> lst = testInstanceF.NewList(aFilter.Text)
    <span style="COLOR: #0000ff">If</span> lst.Count = 0 <span style="COLOR: #0000ff">Then</span>
        <span style="COLOR: #0000ff">Set</span> tstInstance = testInstanceF.AddItem(Null)
    <span style="COLOR: #008000">' Put the new test in the test set.
</span>        tstInstance.Field(<span style="COLOR: #800000">"TC_TEST_ID"</span>) = oTest.ID
    <span style="COLOR: #0000ff">Else</span>
        <span style="COLOR: #0000ff">Set</span> tstInstance = lst.Item(1)
    <span style="COLOR: #0000ff">End</span> <span style="COLOR: #0000ff">If</span>
    tstInstance.Status = <span style="COLOR: #800000">"No Run"</span>
    tstInstance.Post
    <span style="COLOR: #0000ff">Set</span> tstInstance = GetTestInstance(TstSet, oTest)
    
    
<span style="COLOR: #008000">' Create a run of the test instance.
</span>    errmsg = <span style="COLOR: #800000">"Run error"</span>
    <span style="COLOR: #0000ff">Dim</span> RunName$
    RunName = TestName &amp; <span style="COLOR: #800000">"Linked_Run"</span>
    <span style="COLOR: #0000ff">Set</span> RunF = tstInstance.RunFactory
    <span style="COLOR: #0000ff">Set</span> theRun = RunF.AddItem(RunName)
    theRun.Status = <span style="COLOR: #800000">"FAILED"</span>
    theRun.Post
    <span style="COLOR: #0000ff">Set</span> theRun = NewTestInstanceRun(tstInstance, _
            <span style="COLOR: #800000">"FAILED"</span>, RunName$)
    
<span style="COLOR: #008000">'Get the design step created above for the test
' to be associated with this test run.
</span>    errmsg = <span style="COLOR: #800000">"Design steps error"</span>
    theRun.CopyDesignSteps
    theRun.Post
    
<span style="COLOR: #008000">' Add the steps to run and fail them.
</span>    <span style="COLOR: #0000ff">Set</span> runStepF = theRun.StepFactory
    <span style="COLOR: #0000ff">Set</span> lst = runStepF.NewList(<span style="COLOR: #800000">""</span>)
    <span style="COLOR: #0000ff">For</span> <span style="COLOR: #0000ff">Each</span> Item <span style="COLOR: #0000ff">In</span> lst
     <span style="COLOR: #0000ff">Set</span> runStep2 = Item
     runStep2.Status = <span style="COLOR: #800000">"Failed"</span>
     runStep2.Post
    <span style="COLOR: #0000ff">Next</span>
    <span style="COLOR: #0000ff">Dim</span> stepCt <span style="COLOR: #0000ff">As</span> <span style="COLOR: #0000ff">Integer</span>
    stepCt = SetRunStepsStatus(theRun, <span style="COLOR: #800000">"Failed"</span>)
    <span style="COLOR: #0000ff">MsgBox</span> stepCt
    
    
<span style="COLOR: #008000">'------------------------------------------
' Defect Module
'------------------------------------------
' Create new defects.
</span>    <span style="COLOR: #0000ff">Dim</span> bSummary <span style="COLOR: #0000ff">As</span> <span style="COLOR: #0000ff">String</span>
    
    errmsg = <span style="COLOR: #800000">"Create Bugs error"</span>
    <span style="COLOR: #0000ff">Set</span> Bug1 = BugF.AddItem(Null)
    Bug1.Summary = <span style="COLOR: #800000">"Associated to "</span> &amp; TestName
    Bug1.Status = <span style="COLOR: #800000">"New"</span>
    Bug1.Priority = <span style="COLOR: #800000">"3-High"</span>
    Bug1.Field(<span style="COLOR: #800000">"BG_SEVERITY"</span>) = <span style="COLOR: #800000">"3-High"</span>
    Bug1.DetectedBy = c_qcUser
    Bug1.Field(<span style="COLOR: #800000">"BG_DETECTION_DATE"</span>) = <span style="COLOR: #0000ff">Date</span>
    Bug1.Post
    
    bSummary = <span style="COLOR: #800000">"Associated to "</span> &amp; oTest.name
    <span style="COLOR: #0000ff">Set</span> Bug1 = NewBug(bSummary, <span style="COLOR: #800000">"Bug1 LinkDefectsToEntities"</span>, c_qcUser, <span style="COLOR: #800000">"3-High"</span>)
    
    errmsg = <span style="COLOR: #800000">"Create Bug2 error"</span>
    <span style="COLOR: #0000ff">Set</span> Bug2 = BugF.AddItem(Null)
    Bug2.Summary = <span style="COLOR: #800000">"Associated to "</span> &amp; RunName
    Bug2.Status = <span style="COLOR: #800000">"New"</span>
    Bug2.Priority = <span style="COLOR: #800000">"3-High"</span>
    Bug2.Field(<span style="COLOR: #800000">"BG_SEVERITY"</span>) = <span style="COLOR: #800000">"3-High"</span>
    Bug2.DetectedBy = c_qcUser
    Bug2.Field(<span style="COLOR: #800000">"BG_DETECTION_DATE"</span>) = <span style="COLOR: #0000ff">Date</span>
    Bug2.Post

    bSummary = <span style="COLOR: #800000">"Associated to "</span> &amp; theRun.name
    <span style="COLOR: #0000ff">Set</span> Bug2 = NewBug(bSummary, <span style="COLOR: #800000">"Bug2 LinkDefectsToEntities"</span>, c_qcUser, <span style="COLOR: #800000">"3-High"</span>)
    
    errmsg = <span style="COLOR: #800000">"Create Bug2 error"</span>
    <span style="COLOR: #0000ff">Set</span> bug3 = BugF.AddItem(Null)
    bug3.Summary = <span style="COLOR: #800000">"Associated to Run Step "</span> &amp; TestName &amp; <span style="COLOR: #800000">":"</span> &amp; runStep2.name
    bug3.Status = <span style="COLOR: #800000">"New"</span>
    bug3.Priority = <span style="COLOR: #800000">"3-High"</span>
    bug3.Field(<span style="COLOR: #800000">"BG_SEVERITY"</span>) = <span style="COLOR: #800000">"3-High"</span>
    bug3.DetectedBy = c_qcUser
    bug3.Field(<span style="COLOR: #800000">"BG_DETECTION_DATE"</span>) = <span style="COLOR: #0000ff">Date</span>
    bug3.Post

    bSummary = <span style="COLOR: #800000">"Associated to Run Step "</span> &amp; oTest.name &amp; <span style="COLOR: #800000">":"</span> &amp; runStep2.name
    <span style="COLOR: #0000ff">Set</span> bug3 = NewBug(bSummary, <span style="COLOR: #800000">"Bug3 LinkDefectsToEntities"</span>, c_qcUser, <span style="COLOR: #800000">"3-High"</span>)

<span style="COLOR: #008000">' Add associations between diffent entities and bugs.
</span>    <span style="COLOR: #0000ff">Dim</span> BugLinkF <span style="COLOR: #0000ff">As</span> LinkFactory
    <span style="COLOR: #0000ff">Dim</span> b2Test <span style="COLOR: #0000ff">As</span> Link, b2Run <span style="COLOR: #0000ff">As</span> Link, b2Step <span style="COLOR: #0000ff">As</span> Link
    <span style="COLOR: #0000ff">Dim</span> testL <span style="COLOR: #0000ff">As</span> ILinkable, runL <span style="COLOR: #0000ff">As</span> ILinkable, stepL <span style="COLOR: #0000ff">As</span> ILinkable
    <span style="COLOR: #0000ff">Dim</span> anObj <span style="COLOR: #0000ff">As</span> <span style="COLOR: #0000ff">Object</span>
    
<span style="COLOR: #008000">' Cast test to Ilinkable and get bug link factory.
</span>    errmsg = <span style="COLOR: #800000">"Error linking Bug1"</span>
    <span style="COLOR: #0000ff">Set</span> testL = oTest
    <span style="COLOR: #0000ff">Set</span> BugLinkF = testL.BugLinkFactory
    
<span style="COLOR: #008000">' Create a link between Bug1 and the test.
</span>    <span style="COLOR: #0000ff">Set</span> b2Test = BugLinkF.AddItem(Bug1)
    b2Test.LinkType = <span style="COLOR: #800000">"Related"</span>
    b2Test.Post

<span style="COLOR: #008000">' Show the link definition.
</span>    <span style="COLOR: #0000ff">Set</span> anObj = b2Test.LinkedByEntity
    Debug.Print <span style="COLOR: #0000ff">TypeName</span>(anObj), anObj.name <span style="COLOR: #008000">'ITest LinkTest
</span>    <span style="COLOR: #0000ff">Set</span> anObj = b2Test.SourceEntity
    Debug.Print <span style="COLOR: #0000ff">TypeName</span>(anObj), anObj.name <span style="COLOR: #008000">'ITest LinkTest
</span>    <span style="COLOR: #0000ff">Set</span> anObj = b2Test.TargetEntity
    Debug.Print <span style="COLOR: #0000ff">TypeName</span>(anObj), anObj.Summary <span style="COLOR: #008000">'IBug   Associated to LinkTest
</span> 
<span style="COLOR: #008000">' Cast Bug2 to Ilinkable and get bug link factory.
</span>    errmsg = <span style="COLOR: #800000">"Error linking Bug2"</span>
    <span style="COLOR: #0000ff">Set</span> runL = theRun
    <span style="COLOR: #0000ff">Set</span> BugLinkF = runL.BugLinkFactory

<span style="COLOR: #008000">' Create a link between Bug2 and the run.
</span>    <span style="COLOR: #0000ff">Set</span> b2Run = BugLinkF.AddItem(Bug2)
    b2Run.Status = <span style="COLOR: #800000">"No Run"</span> <span style="COLOR: #008000">'Always set a status when creating a run
</span>    b2Run.LinkType = <span style="COLOR: #800000">"Related"</span>
    b2Run.Post

<span style="COLOR: #008000">'Show the link definition
</span>    <span style="COLOR: #0000ff">Set</span> anObj = b2Run.LinkedByEntity
    Debug.Print <span style="COLOR: #0000ff">TypeName</span>(anObj), anObj.name <span style="COLOR: #008000">'IRun2  LinkTestLinked_Run
</span>    <span style="COLOR: #0000ff">Set</span> anObj = b2Run.SourceEntity
    Debug.Print <span style="COLOR: #0000ff">TypeName</span>(anObj), anObj.name <span style="COLOR: #008000">'IRun2  LinkTestLinked_Run
</span>    <span style="COLOR: #0000ff">Set</span> anObj = b2Run.TargetEntity
    Debug.Print <span style="COLOR: #0000ff">TypeName</span>(anObj), anObj.Summary <span style="COLOR: #008000">'IBug Associated to LinkTestLinked_Run
</span>
<span style="COLOR: #008000">' Cast Bug3 to Ilinkable and get bug link factory.
</span>    errmsg = <span style="COLOR: #800000">"Error linking Bug3"</span>
    <span style="COLOR: #0000ff">Set</span> stepL = runStep2
    <span style="COLOR: #0000ff">Set</span> BugLinkF = stepL.BugLinkFactory
    
<span style="COLOR: #008000">' Create a link between Bug3 and the run step.
</span>    <span style="COLOR: #0000ff">Set</span> b2Step = BugLinkF.AddItem(bug3)
    b2Step.LinkType = <span style="COLOR: #800000">"Related"</span>
    b2Step.Post
    
<span style="COLOR: #008000">' Show the link definition.
</span>    <span style="COLOR: #0000ff">Set</span> anObj = b2Step.LinkedByEntity
    Debug.Print <span style="COLOR: #0000ff">TypeName</span>(anObj), anObj.name <span style="COLOR: #008000">'IStep2  LinkTestStep_1
</span>    <span style="COLOR: #0000ff">Set</span> anObj = b2Step.SourceEntity
    Debug.Print <span style="COLOR: #0000ff">TypeName</span>(anObj), anObj.name <span style="COLOR: #008000">'IStep2  LinkTestStep_1
</span>    <span style="COLOR: #0000ff">Set</span> anObj = b2Step.TargetEntity
    Debug.Print <span style="COLOR: #0000ff">TypeName</span>(anObj), anObj.Summary <span style="COLOR: #008000">'IBug Associated to Run Step LinkTest:LinkTestStep_1
</span> 
<span style="COLOR: #008000">'Show the link definition from the bug side.
'Note that source and target are reversed.
</span>    <span style="COLOR: #0000ff">Dim</span> bugL <span style="COLOR: #0000ff">As</span> ILinkable, lList <span style="COLOR: #0000ff">As</span> List, aLink <span style="COLOR: #0000ff">As</span> Link
    <span style="COLOR: #0000ff">Dim</span> bugLF <span style="COLOR: #0000ff">As</span> LinkFactory
    <span style="COLOR: #0000ff">Set</span> bugL = bug3
    Debug.Print
    <span style="COLOR: #0000ff">Set</span> bugLF = bugL.LinkFactory
    <span style="COLOR: #0000ff">Set</span> lList = bugLF.NewList(<span style="COLOR: #800000">""</span>)
    <span style="COLOR: #0000ff">For</span> <span style="COLOR: #0000ff">Each</span> aLink <span style="COLOR: #0000ff">In</span> lList
        <span style="COLOR: #0000ff">Set</span> anObj = aLink.LinkedByEntity
        Debug.Print <span style="COLOR: #0000ff">TypeName</span>(anObj), anObj.name  <span style="COLOR: #008000">' IStep2 LinkTestStep_1
</span>        <span style="COLOR: #0000ff">Set</span> anObj = aLink.SourceEntity
        Debug.Print <span style="COLOR: #0000ff">TypeName</span>(anObj), anObj.Summary <span style="COLOR: #008000">' IBug Associated to Run Step LinkTest:LinkTestStep_1
</span>        <span style="COLOR: #0000ff">Set</span> anObj = aLink.TargetEntity
        Debug.Print <span style="COLOR: #0000ff">TypeName</span>(anObj), anObj.name  <span style="COLOR: #008000">'IStep2 LinkTestStep_1
</span>    <span style="COLOR: #0000ff">Next</span> aLink
CLEANUP:
    <span style="COLOR: #0000ff">On</span> <span style="COLOR: #0000ff">Error</span> <span style="COLOR: #0000ff">GoTo</span> CLEANUPERR
    LinkDefectsToEntities = SUCCESS
    errmsg = <span style="COLOR: #800000">"Failure deleting defects"</span>
    <span style="COLOR: #0000ff">If</span> util_DeleteBug(Bug1) <span style="COLOR: #0000ff">Or</span> util_DeleteBug(Bug2) <span style="COLOR: #0000ff">Or</span> util_DeleteBug(bug3) <span style="COLOR: #0000ff">Then</span>
        LinkDefectsToEntities = VALIDATE_FAILURE
    <span style="COLOR: #0000ff">End</span> <span style="COLOR: #0000ff">If</span>
    
    errmsg = <span style="COLOR: #800000">"Failure deleting labFolder"</span>
    <span style="COLOR: #0000ff">If</span> DeleteTestSetFolder(labFolder, <span style="COLOR: #0000ff">True</span>) <span style="COLOR: #0000ff">Then</span>
        LinkDefectsToEntities = VALIDATE_FAILURE
    <span style="COLOR: #0000ff">End</span> <span style="COLOR: #0000ff">If</span>
    
<span style="COLOR: #0000ff">Exit Function</span>
LinkDefectsToEntitiesErr:
    LinkDefectsToEntities = FAILURE
    <span style="COLOR: #0000ff">GoTo</span> CLEANUP
CLEANUPERR:
     LinkDefectsToEntities = FAILURE
<span style="COLOR: #0000ff">End Function</span>
</pre>
    </div>
</div>

<p><a href="topic80.html" data-auto-update-caption="true">Defect to defect links</a></p>
            <a name="seealsobookmark"></a>
            
        
    </div>
    <div id="FooterContent">
        <div id="merc_footer">
            <!-- Start of Mercury Footer -->
            <hr width="100%" size="0" align="center" style="clear:both;" />
			<table style="border: none; border-collapse: collapse; width: 100%; margin-left: 0; margin-right: auto; margin-top: 0; padding-top: 0">
            <tr>
                <td style="border: none; border-collapse: collapse;">
					<p style="font-size: 85%; text-align: left;direction: ltr;">
					     <a href="_rsc_Legal_Notices.htm#1">&copy 1994 - 2018 EntIT Software LLC</a> | Last updated: January 2018
					</p>
				</td>
                <td style="border: none; border-collapse: collapse;">
						<div id="hp-feedbackLink" style="font-size: 80%;margin: 0px 0px 4px 0px;line-height: 1.25em;text-align: right;">
						<a href="mailto:docteam@microfocus.com?subject=ALM OTA API Reference 12.5x Documentation Feedback: Create various entities and link them">Documentation Feedback</a>
						</div>
	             </td>
			</tr>
			</table>
            <!-- End of Mercury Footer -->
        </div>
    </div>
    
</body>
</html>
