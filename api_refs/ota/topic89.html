<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
<!-- saved from url=(0014)about:internet -->

    <meta http-equiv="X-UA-Compatible" value="IE=9" />

    

    

    <title>Find similar defects</title>
    <meta name="Title" content="Find similar defects"/>    
    
    <script src="script/jquery-1.7.2.min.js" type="text/javascript" id="mshs_support_script"></script>
    <script src="script/jquery-ui-1.8.18.custom.min.js" type="text/javascript"></script>
    <link rel="styleSheet" type="text/css" href="stylesheets/jquery-ui-1.8.18.custom.css" />
    <link rel="styleSheet" type="text/css" href="stylesheets/jquery.qtip.css" />
	
    
	

    <meta name="Description" content="
    
        
            
                
                     

                    
                        
                            Copy Code
                        
                    
                

                
  " />
    
    <link rel="styleSheet" type="text/css" href="stylesheets/topics.2012.css" data-mshv2-stylesheet="/stylesheets/topics.2012.mshv2.css" />
    <script src="script/topics.jqueryplugins.2012.min.js" type="text/javascript"></script>
    <script src="script/topics.2012.js" type="text/javascript"></script>
    
    <meta name="Microsoft.Help.Id" content="fc46c376-2a80-4927-ac52-f92ac15c60b2"/>
    
    
    <meta name="Microsoft.Help.F1" content=""/>
    <meta name="Microsoft.Help.ContentType" content="Concepts" />
    
    
    
    
    
    <link rel="stylesheet" type="text/css" href="stylesheets/slimbox2.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-jquery-common.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-jquery-slimbox.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-jquery-expand.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-boxes.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-expandcollapse.css"></link>
    <script src="script/jquery-1.7.2.min.js" type="text/javascript"></script>
    <script src="script/slimbox2.js" type="text/javascript"></script>
    <script src="script/hs-jquery-common.js" type="text/javascript"></script>
    <script src="script/jquery.fitvids.js" type="text/javascript"></script>
    <script src="script/jquery-expand.js" type="text/javascript"></script>
    <script src="script/swfobject.js" type="text/javascript"></script>
    <script src="script/hs-expandcollapse.js" type="text/javascript"></script>

    
    

    

    
</head>

<body>
    <div id="BeforeHeaderContent">
        
    </div>
    <div id="HeaderContent">
        
            
            <div id="ProjectTitle">ALM Open Test Architecture API Reference (Version 12.5x)</div>
        <div id="PageTitle"><div id="PageTitleText">Find similar defects</div></div>
    </div>
    <div id="AfterHeaderContent">
        <!-- Spacing --> <span id="ToggleAllSectionsLink" class="FunctionLink">
                <label id="CollapseAllLabel">Collapse All</label>
                <label id="ExpandAllLabel" style="display: none;">Expand All</label>
            </span>
        
    </div>
    
    
    
    <div id="BodyContent">
        <innovasys:widgetproperty layout="block" name="Content">
    <div class="FilteredContentVB">
        <table class="SyntaxTable">
            <tbody>
                <tr>
                    <th>&nbsp;</th>

                    <th>
                        <div class="CopyCodeWrapper">
                            <span class="CopyCode">Copy Code</span>
                        </div>
                    </th>
                </tr>

                <tr>
                    <td colspan="2">
                        <pre>
<span style="COLOR: #0000ff">Private</span> <span style="COLOR: #0000ff">Function</span> FindSimilarBugs() <span style="COLOR: #0000ff">As</span> <span style="COLOR: #0000ff">Boolean</span>

<span style="COLOR: #008000">' Search for similar defects
</span>
<span style="COLOR: #008000">'This routine outputs the number of matches and the
'similarity ratios of the first and last match.
'If you run the example, you'll see that the number of
'matches drops as the similarity ratio goes up.
'
</span>    <span style="COLOR: #0000ff">Dim</span> BugFact <span style="COLOR: #0000ff">As</span> BugFactory
    <span style="COLOR: #0000ff">Dim</span> theBug <span style="COLOR: #0000ff">As</span> Bug
    <span style="COLOR: #0000ff">Dim</span> bugList <span style="COLOR: #0000ff">As</span> List
    <span style="COLOR: #0000ff">Dim</span> FactList <span style="COLOR: #0000ff">As</span> FactoryList
    <span style="COLOR: #0000ff">Dim</span> SimRatio <span style="COLOR: #0000ff">As</span> <span style="COLOR: #0000ff">Integer</span>, cnt%
    <span style="COLOR: #0000ff">Dim</span> DescField <span style="COLOR: #0000ff">As</span> TDField, Description$
    <span style="COLOR: #0000ff">Dim</span> FirstLoop <span style="COLOR: #0000ff">As</span> <span style="COLOR: #0000ff">Boolean</span>
    
    <span style="COLOR: #0000ff">On</span> <span style="COLOR: #0000ff">Error</span> <span style="COLOR: #0000ff">GoTo</span> FUNC_ERR
<span style="COLOR: #008000">' Get the bug factory and output the number of defects.
</span>    <span style="COLOR: #008000">'tdc is the global TDConnection object.
</span>    <span style="COLOR: #0000ff">Set</span> BugFact = tdc.BugFactory
    <span style="COLOR: #0000ff">Set</span> bugList = BugFact.NewList(<span style="COLOR: #800000">""</span>)
    cnt = bugList.Count
    Debug.Print <span style="COLOR: #800000">"Total number of defects = "</span> &amp; cnt
    
<span style="COLOR: #008000">' Get a bug object (not important which, for this demo).
</span>    <span style="COLOR: #0000ff">Set</span> theBug = BugFact.Item(1)
  
<span style="COLOR: #008000">' We'll be looking for Summary and Descriptions similar to these:
</span>    Debug.Print <span style="COLOR: #800000">"The Summary: "</span> &amp; vbCrLf &amp; theBug.Summary
<span style="COLOR: #008000">'-----------------------------------------
'Use Bug.Field to
' get the Description from the database field.
</span>    Description = theBug.Field(<span style="COLOR: #800000">"BG_DESCRIPTION"</span>)
    Debug.Print <span style="COLOR: #800000">"The Description: "</span> &amp; vbCrLf &amp; Description &amp; vbCrLf

<span style="COLOR: #008000">' Note that at the low ratios it might be hard to see why the defects match.
' At the higher ratios it is clearer.
</span>    FirstLoop = <span style="COLOR: #0000ff">True</span>
    <span style="COLOR: #0000ff">For</span> SimRatio = 10 <span style="COLOR: #0000ff">To</span> 100 <span style="COLOR: #0000ff">Step</span> 20
<span style="COLOR: #008000">'-----------------------------------------
' Use Bug.FindSimilarBugs.
</span>        <span style="COLOR: #0000ff">Set</span> FactList = theBug.FindSimilarBugs(SimRatio)
        Debug.Print <span style="COLOR: #800000">"-----------------------------------------"</span> &amp; vbCrLf
        cnt = FactList.Count
        Debug.Print <span style="COLOR: #800000">"Number of matches found for ratio of "</span> &amp; SimRatio &amp; <span style="COLOR: #800000">" = "</span> &amp; cnt
        <span style="COLOR: #0000ff">If</span> cnt = 0 <span style="COLOR: #0000ff">Then</span> <span style="COLOR: #0000ff">Exit</span> <span style="COLOR: #0000ff">For</span>
<span style="COLOR: #008000">'-----------------------------------------
' Use FactoryList.Ratio and FactoryList.Item.
</span>
        Debug.Print <span style="COLOR: #800000">"------------"</span>
        Debug.Print <span style="COLOR: #800000">"First match ID: "</span> &amp; FactList.Item(1).ID
        Debug.Print <span style="COLOR: #800000">"Ratio of first match = "</span> &amp; FactList.Ratio(1)
        Debug.Print <span style="COLOR: #800000">"Summary:"</span> &amp; vbCrLf &amp; FactList.Item(1).Summary
        Debug.Print <span style="COLOR: #800000">"Description"</span> &amp; vbCrLf &amp; FactList.Item(1).Field(<span style="COLOR: #800000">"BG_DESCRIPTION"</span>)
    
       
        Debug.Print <span style="COLOR: #800000">"------------"</span>
        Debug.Print <span style="COLOR: #800000">"Last match ID: "</span> &amp; FactList.Item(cnt).ID
         <span style="COLOR: #008000">'The last will always be the same item. Output text once.
</span>        <span style="COLOR: #0000ff">If</span> FirstLoop <span style="COLOR: #0000ff">Then</span>
            Debug.Print <span style="COLOR: #800000">"Ratio of last match = "</span> &amp; FactList.Ratio(cnt)
            Debug.Print <span style="COLOR: #800000">"Summary:"</span> &amp; vbCrLf &amp; FactList.Item(cnt).Summary
            Debug.Print <span style="COLOR: #800000">"Description"</span> &amp; vbCrLf &amp; FactList.Item(cnt).Field(<span style="COLOR: #800000">"BG_DESCRIPTION"</span>)
            FirstLoop = <span style="COLOR: #0000ff">False</span>
        <span style="COLOR: #0000ff">End</span> <span style="COLOR: #0000ff">If</span>
        
    <span style="COLOR: #0000ff">Next</span> SimRatio

    FindSimilarBugs = SUCCESS
<span style="COLOR: #0000ff">Exit Function</span>
FUNC_ERR:
    FindSimilarBugs = FAILURE
<span style="COLOR: #0000ff">End Function</span>
</pre>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</innovasys:widgetproperty>
            <a name="seealsobookmark"></a>
            
        
    </div>
    <div id="FooterContent">
        <div id="merc_footer">
            <!-- Start of Mercury Footer -->
            <hr width="100%" size="0" align="center" style="clear:both;" />
			<table style="border: none; border-collapse: collapse; width: 100%; margin-left: 0; margin-right: auto; margin-top: 0; padding-top: 0">
            <tr>
                <td style="border: none; border-collapse: collapse;">
					<p style="font-size: 85%; text-align: left;direction: ltr;">
					     <a href="_rsc_Legal_Notices.htm#1">&copy 1994 - 2018 EntIT Software LLC</a> | Last updated: January 2018
					</p>
				</td>
                <td style="border: none; border-collapse: collapse;">
						<div id="hp-feedbackLink" style="font-size: 80%;margin: 0px 0px 4px 0px;line-height: 1.25em;text-align: right;">
						<a href="mailto:docteam@microfocus.com?subject=ALM OTA API Reference 12.5x Documentation Feedback: Find similar defects">Documentation Feedback</a>
						</div>
	             </td>
			</tr>
			</table>
            <!-- End of Mercury Footer -->
        </div>
    </div>
    
</body>
</html>
