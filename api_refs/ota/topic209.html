<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
<!-- saved from url=(0014)about:internet -->

    <meta http-equiv="X-UA-Compatible" value="IE=9" />

    

    

    <title>Run the test instances in a test set locally, remotely, or as planned</title>
    <meta name="Title" content="Run the test instances in a test set locally, remotely, or as planned"/>    
    
    <script src="script/jquery-1.7.2.min.js" type="text/javascript" id="mshs_support_script"></script>
    <script src="script/jquery-ui-1.8.18.custom.min.js" type="text/javascript"></script>
    <link rel="styleSheet" type="text/css" href="stylesheets/jquery-ui-1.8.18.custom.css" />
    <link rel="styleSheet" type="text/css" href="stylesheets/jquery.qtip.css" />
	
    
	

    <meta name="Description" content="
    
        TestSet Examples
    

    
        
Public Sub RunTestSet(tsFolderName As String, tSetName As String, _
        HostName As String, runWhere As Integer)

' Run the test instances in a test set locally, remotely, or as planned" />
    
    <link rel="styleSheet" type="text/css" href="stylesheets/topics.2012.css" data-mshv2-stylesheet="/stylesheets/topics.2012.mshv2.css" />
    <script src="script/topics.jqueryplugins.2012.min.js" type="text/javascript"></script>
    <script src="script/topics.2012.js" type="text/javascript"></script>
    
    <meta name="Microsoft.Help.Id" content="66d8700c-0e4f-4920-b076-4aaf3e094a90"/>
    
    
    <meta name="Microsoft.Help.F1" content=""/>
    <meta name="Microsoft.Help.ContentType" content="Concepts" />
    
    
    
    
    
    <link rel="stylesheet" type="text/css" href="stylesheets/slimbox2.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-jquery-common.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-jquery-slimbox.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-jquery-expand.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-boxes.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-expandcollapse.css"></link>
    <script src="script/jquery-1.7.2.min.js" type="text/javascript"></script>
    <script src="script/slimbox2.js" type="text/javascript"></script>
    <script src="script/hs-jquery-common.js" type="text/javascript"></script>
    <script src="script/jquery.fitvids.js" type="text/javascript"></script>
    <script src="script/jquery-expand.js" type="text/javascript"></script>
    <script src="script/swfobject.js" type="text/javascript"></script>
    <script src="script/hs-expandcollapse.js" type="text/javascript"></script>

    
    

    

    
</head>

<body>
    <div id="BeforeHeaderContent">
        
    </div>
    <div id="HeaderContent">
        
            
            <div id="ProjectTitle">ALM Open Test Architecture API Reference (Version 12.5x)</div>
        <div id="PageTitle"><div id="PageTitleText">Run the test instances in a test set locally, remotely, or as planned</div></div>
    </div>
    <div id="AfterHeaderContent">
        <!-- Spacing --> <span id="ToggleAllSectionsLink" class="FunctionLink">
                <label id="CollapseAllLabel">Collapse All</label>
                <label id="ExpandAllLabel" style="display: none;">Expand All</label>
            </span>
        
    </div>
    
    
    
    <div id="BodyContent">
        <div class="FilteredContentVisual Basic TabContainer TabContainerWidget" data-title="TestSet Examples" data-itemid="Visual Basic">
    <ul>
        <li><a href="#TabContent-2d6a2639-7504-4261-83c6-1e84f09ea9ca">TestSet Examples</a></li>
    </ul>

    <div id="TabContent-2d6a2639-7504-4261-83c6-1e84f09ea9ca" class="FilteredContent code">
        <pre>
<span style="COLOR: #0000ff">Public</span> <span style="COLOR: #0000ff">Sub</span> RunTestSet(tsFolderName <span style="COLOR: #0000ff">As</span> <span style="COLOR: #0000ff">String</span>, tSetName <span style="COLOR: #0000ff">As</span> <span style="COLOR: #0000ff">String</span>, _
        HostName <span style="COLOR: #0000ff">As</span> <span style="COLOR: #0000ff">String</span>, runWhere <span style="COLOR: #0000ff">As</span> <span style="COLOR: #0000ff">Integer</span>)

<span style="COLOR: #008000">' Run the test instances in a test set locally, remotely, or as planned
' Get status information when running a test set
</span>
<span style="COLOR: #008000">' This example show how to run a test set in three different ways:
' * Run all tests on the local machine (where this code runs).
' * Run the tests on a specified remote machine.
' * Run the tests on the hosts as planned in the test set.
</span>    <span style="COLOR: #0000ff">Dim</span> TSetFact <span style="COLOR: #0000ff">As</span> TestSetFactory, tsList <span style="COLOR: #0000ff">As</span> List
    <span style="COLOR: #0000ff">Dim</span> theTestSet <span style="COLOR: #0000ff">As</span> TestSet
    <span style="COLOR: #0000ff">Dim</span> tsTreeMgr <span style="COLOR: #0000ff">As</span> TestSetTreeManager
    <span style="COLOR: #0000ff">Dim</span> tsFolder <span style="COLOR: #0000ff">As</span> TestSetFolder
    <span style="COLOR: #0000ff">Dim</span> Scheduler <span style="COLOR: #0000ff">As</span> TSScheduler
    <span style="COLOR: #0000ff">Dim</span> execStatus <span style="COLOR: #0000ff">As</span> ExecutionStatus
    
    <span style="COLOR: #0000ff">On</span> <span style="COLOR: #0000ff">Error</span> <span style="COLOR: #0000ff">GoTo</span> RunTestSetErr
    errmsg = <span style="COLOR: #800000">"RunTestSet"</span>
<span style="COLOR: #008000">' Get the test set tree manager from the test set factory.
</span>    <span style="COLOR: #008000">'tdc is the global TDConnection object.
</span>    <span style="COLOR: #0000ff">Set</span> TSetFact = tdc.TestSetFactory
    <span style="COLOR: #0000ff">Set</span> tsTreeMgr = tdc.TestSetTreeManager
<span style="COLOR: #008000">' Get the test set folder passed as an argument to the example code.
</span>    <span style="COLOR: #0000ff">Dim</span> nPath$
    nPath = <span style="COLOR: #800000">"Root\"</span> &amp; <span style="COLOR: #0000ff">Trim</span>(tsFolderName)
    <span style="COLOR: #0000ff">On</span> <span style="COLOR: #0000ff">Error</span> <span style="COLOR: #0000ff">Resume</span> <span style="COLOR: #0000ff">Next</span>
    <span style="COLOR: #0000ff">Set</span> tsFolder = tsTreeMgr.NodeByPath(nPath)
 
    <span style="COLOR: #0000ff">If</span> tsFolder <span style="COLOR: #0000ff">Is</span> <span style="COLOR: #0000ff">Nothing</span> <span style="COLOR: #0000ff">Then</span>
        err.Raise vbObjectError + 1, <span style="COLOR: #800000">"RunTestSet"</span>, <span style="COLOR: #800000">"Could not find folder "</span> &amp; nPath
        <span style="COLOR: #0000ff">GoTo</span> RunTestSetErr
    <span style="COLOR: #0000ff">End</span> <span style="COLOR: #0000ff">If</span>
    <span style="COLOR: #0000ff">On</span> <span style="COLOR: #0000ff">Error</span> <span style="COLOR: #0000ff">GoTo</span> RunTestSetErr
<span style="COLOR: #008000">' Search for the test set passed as an argument to the example code.
</span>    <span style="COLOR: #0000ff">Set</span> tsList = tsFolder.FindTestSets(tSetName)
    <span style="COLOR: #0000ff">If</span> tsList.Count &gt; 1 <span style="COLOR: #0000ff">Then</span>
        <span style="COLOR: #0000ff">MsgBox</span> <span style="COLOR: #800000">"FindTestSets found more than one test set: refine search"</span>
    <span style="COLOR: #0000ff">ElseIf</span> tsList.Count &lt; 1 <span style="COLOR: #0000ff">Then</span>
        <span style="COLOR: #0000ff">MsgBox</span> <span style="COLOR: #800000">"FindTestSets: test set not found"</span>
    <span style="COLOR: #0000ff">End</span> <span style="COLOR: #0000ff">If</span>
    
    <span style="COLOR: #0000ff">Set</span> theTestSet = tsList.Item(1)
    Debug.Print theTestSet.ID

<span style="COLOR: #008000">' Start the scheduler on the local machine.
</span>    <span style="COLOR: #0000ff">Set</span> Scheduler = theTestSet.StartExecution(<span style="COLOR: #800000">""</span>)

<span style="COLOR: #008000">'Set up for the run depending on where the test instances
' are to execute.
</span>    
    <span style="COLOR: #0000ff">Select</span> <span style="COLOR: #0000ff">Case</span> runWhere
        
        <span style="COLOR: #0000ff">Case</span> RUN_LOCAL
        <span style="COLOR: #008000">' Run all tests on the local machine.
</span>            Scheduler.RunAllLocally = <span style="COLOR: #0000ff">True</span>
        <span style="COLOR: #0000ff">Case</span> RUN_REMOTE
        <span style="COLOR: #008000">' Run tests on a specified remote machine.
</span>            Scheduler.TdHostName = HostName
            <span style="COLOR: #008000">' RunAllLocally must not be set for
</span>            <span style="COLOR: #008000">' remote invocation of tests.
</span>            <span style="COLOR: #008000">' Do not do this:
</span>            <span style="COLOR: #008000">' Scheduler.RunAllLocally = False
</span>        <span style="COLOR: #0000ff">Case</span> RUN_PLANNED_HOST
        <span style="COLOR: #008000">' Run on the hosts as planned in the test set.
</span>            <span style="COLOR: #0000ff">Dim</span> TSTestFact <span style="COLOR: #0000ff">As</span> TSTestFactory, testList <span style="COLOR: #0000ff">As</span> List
            <span style="COLOR: #0000ff">Dim</span> tsFilter <span style="COLOR: #0000ff">As</span> TDFilter
            <span style="COLOR: #0000ff">Dim</span> TSTst <span style="COLOR: #0000ff">As</span> TSTest
        <span style="COLOR: #008000">' Get the test instances from the test set.
</span>            <span style="COLOR: #0000ff">Set</span> TSTestFact = theTestSet.TSTestFactory
            <span style="COLOR: #0000ff">Set</span> tsFilter = TSTestFact.Filter
            tsFilter.Filter(<span style="COLOR: #800000">"TC_CYCLE_ID"</span>) = theTestSet.ID
            <span style="COLOR: #0000ff">Set</span> testList = TSTestFact.NewList(tsFilter.Text)
            Debug.Print <span style="COLOR: #800000">"Test instances and planned hosts:"</span>
        <span style="COLOR: #008000">'For each test instance, set the host to run depending
</span>        <span style="COLOR: #008000">'  on the planning in the test set.
</span>            <span style="COLOR: #0000ff">For</span> <span style="COLOR: #0000ff">Each</span> TSTst <span style="COLOR: #0000ff">In</span> testList
                Debug.Print <span style="COLOR: #800000">"Name: "</span> &amp; TSTst.Name &amp; <span style="COLOR: #800000">" ID: "</span> &amp; TSTst.ID &amp; <span style="COLOR: #800000">" Planned Host: "</span> &amp; TSTst.HostName
                Scheduler.RunOnHost(TSTst.ID) = TSTst.HostName
            <span style="COLOR: #0000ff">Next</span> TSTst
    
            Scheduler.RunAllLocally = <span style="COLOR: #0000ff">False</span>
    <span style="COLOR: #0000ff">End</span> <span style="COLOR: #0000ff">Select</span>
<span style="COLOR: #008000">' Run the tests.
</span>    Scheduler.Run
<span style="COLOR: #008000">' Get the execution status object.
</span>    <span style="COLOR: #0000ff">Set</span> execStatus = Scheduler.ExecutionStatus
<span style="COLOR: #008000">' Track the events and statuses.
</span>    <span style="COLOR: #0000ff">Dim</span> RunFinished <span style="COLOR: #0000ff">As</span> <span style="COLOR: #0000ff">Boolean</span>, iter <span style="COLOR: #0000ff">As</span> <span style="COLOR: #0000ff">Integer</span>, i <span style="COLOR: #0000ff">As</span> <span style="COLOR: #0000ff">Integer</span>
    <span style="COLOR: #0000ff">Dim</span> ExecEventInfoObj <span style="COLOR: #0000ff">As</span> ExecEventInfo, EventsList <span style="COLOR: #0000ff">As</span> List
    <span style="COLOR: #0000ff">Dim</span> TestExecStatusObj <span style="COLOR: #0000ff">As</span> TestExecStatus
    <span style="COLOR: #0000ff">While</span> ((RunFinished = <span style="COLOR: #0000ff">False</span>) <span style="COLOR: #0000ff">And</span> (iter &lt; 100))
        iter = iter + 1
        execStatus.RefreshExecStatusInfo <span style="COLOR: #800000">"all"</span>, <span style="COLOR: #0000ff">True</span>
        RunFinished = execStatus.Finished
        <span style="COLOR: #0000ff">Set</span> EventsList = execStatus.EventsList
   
        <span style="COLOR: #0000ff">For</span> <span style="COLOR: #0000ff">Each</span> ExecEventInfoObj <span style="COLOR: #0000ff">In</span> EventsList
            Debug.Print <span style="COLOR: #0000ff">Tab</span>; <span style="COLOR: #800000">"Event: "</span> &amp; ExecEventInfoObj.EventDate &amp; <span style="COLOR: #800000">" "</span> &amp; _
                    ExecEventInfoObj.EventTime &amp; <span style="COLOR: #800000">" "</span> &amp; _
                    <span style="COLOR: #800000">"Event Type: "</span> &amp; ExecEventInfoObj.EventType &amp; <span style="COLOR: #800000">" [Event types: "</span> &amp; _
                    <span style="COLOR: #800000">"1-fail, 2-finished, 3-env fail, 4-timeout, 5-manual]"</span>
        <span style="COLOR: #0000ff">Next</span>
        
        Debug.Print <span style="COLOR: #0000ff">Tab</span>; execStatus.Count &amp; <span style="COLOR: #800000">" exec status"</span>
        <span style="COLOR: #0000ff">For</span> i = 1 <span style="COLOR: #0000ff">To</span> execStatus.Count
            <span style="COLOR: #0000ff">Set</span> TestExecStatusObj = execStatus.Item(i)
            Debug.Print <span style="COLOR: #0000ff">Tab</span>; <span style="COLOR: #800000">"Iteration "</span> &amp; iter &amp; <span style="COLOR: #800000">" Status: "</span> &amp; _
                        <span style="COLOR: #800000">" Test "</span> &amp; TestExecStatusObj.testID &amp; _
                        <span style="COLOR: #800000">" ,Test instance "</span> &amp; TestExecStatusObj.TestInstance &amp; _
                        <span style="COLOR: #800000">" ,order "</span> &amp; TestExecStatusObj.TSTestID &amp; <span style="COLOR: #800000">" "</span> &amp; _
                        TestExecStatusObj.Message &amp; <span style="COLOR: #800000">", status="</span> &amp; _
                        TestExecStatusObj.Status
        <span style="COLOR: #0000ff">Next</span> i
        <span style="COLOR: #008000">'Sleep() has to be declared before it can be used.
</span>        <span style="COLOR: #008000">'This is the module level declaration of Sleep():
</span>        <span style="COLOR: #008000">'Declare Sub Sleep Lib "kernel32" (ByVal dwMilliseconds As Long)
</span>        Sleep (5000)
        
    Wend <span style="COLOR: #008000">'Loop While execStatus.Finished = False
</span>  
    Debug.Print <span style="COLOR: #800000">"Scheduler finished around "</span> &amp; <span style="COLOR: #0000ff">CStr</span>(Now)
    Debug.Print
    
<span style="COLOR: #0000ff">Exit Sub</span>
RunTestSetErr:
<span style="COLOR: #008000">' Handle error
</span><span style="COLOR: #0000ff">End Sub</span>
</pre>
    </div>
</div>
            <a name="seealsobookmark"></a>
            
        
    </div>
    <div id="FooterContent">
        <div id="merc_footer">
            <!-- Start of Mercury Footer -->
            <hr width="100%" size="0" align="center" style="clear:both;" />
			<table style="border: none; border-collapse: collapse; width: 100%; margin-left: 0; margin-right: auto; margin-top: 0; padding-top: 0">
            <tr>
                <td style="border: none; border-collapse: collapse;">
					<p style="font-size: 85%; text-align: left;direction: ltr;">
					     <a href="_rsc_Legal_Notices.htm#1">&copy 1994 - 2018 EntIT Software LLC</a> | Last updated: January 2018
					</p>
				</td>
                <td style="border: none; border-collapse: collapse;">
						<div id="hp-feedbackLink" style="font-size: 80%;margin: 0px 0px 4px 0px;line-height: 1.25em;text-align: right;">
						<a href="mailto:docteam@microfocus.com?subject=ALM OTA API Reference 12.5x Documentation Feedback: Run the test instances in a test set locally, remotely, or as planned">Documentation Feedback</a>
						</div>
	             </td>
			</tr>
			</table>
            <!-- End of Mercury Footer -->
        </div>
    </div>
    
</body>
</html>
