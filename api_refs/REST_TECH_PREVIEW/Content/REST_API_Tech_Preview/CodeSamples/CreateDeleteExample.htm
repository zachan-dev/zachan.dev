<!DOCTYPE html>
<!--QCCR1K4344-->
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="ALM_REST_API_TP.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Example Application">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>CreateDeleteExample</title>
        <!-- Google Tag Manager -->
        <script type="text/javascript">/*<![CDATA[*/(function(w,d,s,l,i){if(location.protocol.toLowerCase().indexOf('file:')===0)return;w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
		})(window,document,'script','dataLayer','GTM-NJ9842');/*]]>*/</script>
        <!-- End Google Tag Manager -->
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" data-mc-generated="True" />
        <style>
            <link rel="icon" type="image/x-icon" href="https://software.microfocus.com/favicon.ico" />
		
			html, body 
			{
				height: 100%;
				margin-right:2em;
			}
						
			.wrapper 
			{
				min-height: 100%!important;
				margin: 0 auto -10em; 
				padding-left: 0.2em
						
			}

			footer, .float 
			{
				height: 10em; 
				margin:0;
				clear: both;
			}

			div.roundcorners
			{
				-moz-border-radius-bottomleft: 1em;
				border-bottom-left-radius: 1em;
				-moz-border-radius-topright: 1em;
				border-top-right-radius: 1em;
				background-color: #f2f2f2 ;
				width: 100% !important;
				padding: 0em;		 
			}
			
			p.footerlink
			{
				font-size: .75em;
				line-height: 1em;
				padding: 0em;
				margin-top:0;
				margin-bottom:.75em;
			}
			
			p.footerlink a,
			p.footerlink a:visited
			{
				color: #5a5a5a;
			}
			
			p.footerlink a:hover
			{
				color: #000000!important;
			}
						
			p.spacer
			{
				font-size: .5em;
				line-height: .5em;
				padding: 0em;
				margin-top:0;
				margin-bottom: .5em;
			}
	
    </style>
        <link href="../../Resources/Stylesheets/API_TechPreview.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop"><a href="../../../ALM_REST_API_TP.html#REST_API_Tech_Preview/CodeSamples/CreateDeleteExample.htm">Open topic with navigation</a>
        </p>
        <div class="wrapper">
            <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix">  <![CDATA[ ]]></span><a class="MCBreadcrumbsLink" href="../General/Example_Application.html">Example Application</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">CreateDeleteExample</span>
            </div>
            <h1>CreateDeleteExample</h1><pre xml:space="preserve">
package org.hp.qc.web.restapi.docexamples.docexamples;

import org.hp.qc.web.restapi.docexamples.docexamples.infrastructure.Assert;
        import org.hp.qc.web.restapi.docexamples.docexamples.infrastructure.Constants;
        import org.hp.qc.web.restapi.docexamples.docexamples.infrastructure.Response;
        import org.hp.qc.web.restapi.docexamples.docexamples.infrastructure.RestConnector;

        import java.net.HttpURLConnection;
        import java.util.HashMap;
        import java.util.Map;

/**
 * This example shows multiple ways to create an entity,
 * and how to remove entities.
 *
 */
public class CreateDeleteExample {

    public static void main(String[] args) throws Exception {
        new CreateDeleteExample().createDeleteExample(
                "http://" + Constants.HOST + ":" +
                        Constants.PORT + "/qcbin",
                Constants.DOMAIN,
                Constants.PROJECT,
                Constants.USERNAME,
                Constants.PASSWORD);
    }

    public void createDeleteExample(final String serverUrl,
                                    final String domain, final String project, String username,
                                    String password) throws Exception {

        RestConnector con =
                RestConnector.getInstance().init(
                        new HashMap&lt;String, String&gt;(),
                        serverUrl,
                        domain,
                        project);

        // use the login example to learn how to authenticate properly.
        // we use that functionality here to login so that we can do more
        // complex actions.
        AuthenticateLoginLogoutExample login =
                new AuthenticateLoginLogoutExample();
        CreateDeleteExample example = new CreateDeleteExample();

        boolean loginResult = login.login(username, password);
        Assert.assertTrue("failed to login", loginResult);

        // Build the location of the requirements collection, and the
        // XML for an entity of type requirement
        String requirementsUrl = con.buildEntityCollectionUrl("requirement");

        //create the entity on the server-side, keep it's url
        String newlyCreatedEntityUrl =
                example.createEntity(requirementsUrl, Constants.entityToPostXml);

        String deletedEntityResponse =
                example.deleteEntity(newlyCreatedEntityUrl);
        Assert.assertTrue(
                "deleted entity didn't contain posted field.",
                deletedEntityResponse.contains(Constants.entityToPostFieldXml));

        /* Now do the same only this time using an object, and not string xml.
        (Though we do build the object from the xml, we could have instantiated
        it differently, theoretically.)
        The reason we build it with post and not createEntity, is that when
        posting, the returned value is an xml representation */
        Map&lt;String, String&gt; requestHeaders = new HashMap&lt;String, String&gt;();
        requestHeaders.put("Content-Type", "application/xml");
        requestHeaders.put("Accept", "application/xml");
        Response postedEntityResponse =
                con.httpPost
                        (requirementsUrl, Constants.entityToPostXml.getBytes(),
                                requestHeaders);

        Assert.assertEquals(
                "failed to post new entity.",
                postedEntityResponse.getStatusCode(),
                HttpURLConnection.HTTP_CREATED);

        String postedEntityResponseXml = postedEntityResponse.toString();
        Assert.assertTrue(
                "element returned from server doesn't contain posted data",
                postedEntityResponseXml.contains(Constants.entityToPostFieldXml));

        //getting the location of the new entity from the post response...
        newlyCreatedEntityUrl =
                postedEntityResponse.getResponseHeaders().get("Location").iterator().next();

        deletedEntityResponse = example.deleteEntity(newlyCreatedEntityUrl);
        Assert.assertEquals
                ("posted entity does not equal deleted entity response",
                        deletedEntityResponse, postedEntityResponseXml);

        login.logout();
    }

    private RestConnector con;

    public CreateDeleteExample() {
        con = RestConnector.getInstance();
    }

    /**
     * @param collectionUrl
     *            the url of the collection of the relevant entity type.
     * @param postedEntityXml
     *            the xml describing an instance of said entity type.
     * @return the url of the newly created entity.
     */
    public String createEntity(String collectionUrl, String postedEntityXml)
            throws Exception {

        Map&lt;String, String&gt; requestHeaders = new HashMap&lt;String, String&gt;();
        requestHeaders.put("Content-Type", "application/xml");
        requestHeaders.put("Accept", "application/xml");

        // As can be seen in the implementation below, creating an entity
        //is simply posting its xml into the correct collection.
        Response response = con.httpPost(collectionUrl,
                postedEntityXml.getBytes(), requestHeaders);

        Exception failure = response.getFailure();
        if (failure != null) {
            throw failure;
        }

        /*
         Note that we also get the xml of the newly created entity.
         at the same time we get the url where it was created in a
         location response header.
        */
        String entityUrl =
                response.getResponseHeaders().get("Location").iterator().next();

        return entityUrl;
    }

    /**
     * @param entityUrl
     *            the url of the entity that we wish to remove
     * @return xml of deleted entity
     */
    public String deleteEntity(String entityUrl) throws Exception {

        // As we can see from the implementation below, to delete an entity
        // is simply to use HTTP delete on its url.
        Map&lt;String, String&gt; requestHeaders = new HashMap&lt;String, String&gt;();
        requestHeaders.put("Accept", "application/xml");

        Response serverResponse = con.httpDelete(entityUrl, requestHeaders);
        if (serverResponse.getStatusCode() != HttpURLConnection.HTTP_OK) {
            throw new Exception(serverResponse.toString());
        }

        return serverResponse.toString();
    }

}

		</pre>
            <p>&#160;</p>
            <!--        hr width="100%" size="4" align="center" padding-bottom="0" style="clear:both" /> -->
            <div class="float">
            </div>
        </div>
        <div class="footer">
            <MadCap:conditionalText data-mc-conditions="_rsc_Conditions.Footer">
                <div class="roundcorners">
                    <table style="border: none; margin-left: auto;       margin-right: auto;  width: 60%; margin-bottom: 0em">
                        <tr>
                            <td style="width: 33.3%;border: none; border-collapse: collapse;"> Explore  <!--Localizeable--><p class="spacer">&#160;</p><p class="footerlink"><a href="http://admhelp.microfocus.com/" target="_blank">More ADM Help Centers</a></p></td>
                            <td style="width: 33.3%;border: none; border-collapse: collapse;"> Connect  <!--Localizeable--><p class="spacer">&#160;</p><p class="footerlink"><a href="https://software.microfocus.com/en-us/software/alm-software-development-testing/try-now" target="_blank">Try&#160;<span class="QCPCALM">ALM</span></a></p><p class="footerlink"><a href="https://community.softwaregrp.com/t5/Quality-Center-ALM/ct-p/sws-QC" target="_blank">ALM Community</a></p><p class="footerlink"><a href="https://marketplace.microfocus.com/" target="_blank">Marketplace</a></p><p class="footerlink"><a href="http://saastube.software.microfocus.com/category/videos/quality-center" target="_blank">SaaS-Tube</a></p><p class="footerlink"><a href="https://twitter.com/MicroFocusDev" target="_blank" title="ALM on Twitter" alt="ALM on Twitter"><img src="../../Resources/Images/_rsc_Twitter_blue.png" style="width: 20px;height: 20px;" /></a><a href="https://www.linkedin.com/groups/4855477/profile" target="_blank" title="ALM Customer Forum on LinkedIn" alt="ALM Customer Forum on LinkedIn" data-mc-conditions="Project_Conditions.Removed">&#160;&#160;&#160;<img src="../../Resources/Images/_rsc_Linkedin_blue.png" style="width: 20px;height: 20px;" data-mc-conditions="Project_Conditions.Removed" /></a></p></td>
                            <td style="width: 33.3%;border: none; border-collapse: collapse;"> Contact  <!--Localizeable--><p class="spacer">&#160;</p><!--<p class="footerlink"><a href="mailto:[%=_rscC_Basic_Variables._rsc_Product_IE_Team_PDL%]?subject=Feedback on [%=_rscC_Basic_Variables._rsc_Book_Title%] ([%=_rscC_Basic_Variables._rsc_Product_Name%] [%=_rscC_Basic_Variables._rsc_Product_Version%])" title="Send your doc feedback to [%=_rscC_Basic_Variables._rsc_Product_IE_Team_PDL%]" alt="Send your doc feedback to [%=_rscC_Basic_Variables._rsc_Product_IE_Team_PDL%]">Send Documentation Feedback&#160;</a>
        </p>--><p class="footerlink"><a href="javascript:sendFeedback();" class="avoidPrint" data-mc-conditions="_rsc_Conditions.Footer">Send Documentation Feedback</a></p><!-- Localizable --><div id="hp-feedbackDiv" class="MCTextPopupBody" style="display:none; word-wrap:break-word;"><div style="position: absolute;top: 2px;right: 2px;text-align: right;"><a href="javascript:closeFeedback();" id="hp-feedbackClose">Close</a></div><div style="text-align:left"><!-- Localizable --><p style="font-weight: bold; margin-top: 1.0em;">Send us feedback</p><p style="margin-top: 1.0em;font-weight: normal;">Can we improve our help? Tell us how! <br /></p><!-- Localizable --><hr /><p>Send us an email with the following information:</p><!-- Localizable --><div id="hp-feedbackBody"><br /><br />Product name: <span id="hp-feedbackProduct"></span><span id="hp-feedbackAcronym"></span>&#160;<span id="hp-feedbackVersion"></span><br /><br />Topic title: <span id="hp-feedbackTopic"></span><br /><br />Your feedback<br /><br /><br /><br /></div><p>Send the email to: <a name="hp-feedbackOpen" id="hp-feedbackOpen" style="color: #0073E7;">docteam@microfocus.com</a></p><!-- Localizable --><hr /></div></div><div style="display:none;" id="hp-feedback-variables" productName="ALM REST API Reference (Technical Preview)" productVersion="12.5x" commentsEmailAddress="docteam@microfocus.com" productAcronym="ALM" topicTitle="CreateDeleteExample" skinLine1="ALM 12.5x REST API Reference (Technical Preview)" skinLine2="">&#160;
		<p style="display:none;"><script src="../../Resources/MasterPages/_rsc_Feedback.js"></script></p></div><p class="footerlink" data-mc-conditions="_TopNav_Conditions.GetSupport"><a href="https://software.microfocus.com/en-us/software/customer-technical-support-services" target="_blank">Get Support</a></p></td>
                        </tr>
                    </table>
                    <table class="no_lines" style="border-top:1px solid #B9B8BB;  width:80%; margin-left: auto; margin-right: auto;  ">
                        <tr>
                            <td style="vertical-align: middle; font-size: .65em; text-align: center;direction: ltr;">Last updated <span class="_rscC_Basic_Variables_rsc_LastUpdatedDate">January 18, 2018</span>&#160;|&#160;<a href="../../Resources/MasterPages/_rsc_Legal_Notices.htm#1">© <span class="_rscC_Basic_Variables_rsc_Copyright_Date_Range">2002 - 2018</span>&#160;<span class="_rscB_Branding_Variables_rsc_Copyright_Name">EntIT Software LLC</span></a></td>
                        </tr>
                    </table>
                </div>
            </MadCap:conditionalText>
            <p style="visibility:hidden"> <![CDATA[ ]]></p>
            <p><a href="../../Resources/MasterPages/_rsc_HTML5_bannerTitle.htm" style="visibility: hidden;"></a><a href="../../Resources/MasterPages/_rsc_aboutSearch.htm" style="visibility: hidden;"></a>
            </p>
        </div>
    </body>
</html>